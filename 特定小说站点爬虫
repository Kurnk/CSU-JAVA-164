# !/usr/bin/env python
# -*- coding:utf-8
import requests
import re
# Download a novel url
url = 'http://www.yznnw.com/files/article/html/1/1129/index.html'

# get the response data
response = requests.get(url)

# Text transcoding
response.encoding = 'gbk'

# Converts the response data into text
html = response.text

# Get part of the novel url(substring)
#pageU = re.findall(r'<span id=".*?title', html, re.S)
#pageUV = ''.join(pageU)
#pageUrl = re.findall('href="(.*?).html', pageUV)
#pageUrl = ''.join(pageUrl)

# get title
title = re.findall(r'<title>(.*?)</title>', html, re.S)
titleV = ''.join(title).split("_")
titleV = titleV[0].replace("小说", "")

# Create a new TXT file (use for store novel)
# fb = open('%s.txt' % titleV, 'w', encoding= 'GBK')
with open('%s.txt' % titleV, 'w') as fb:

# Get the address and title of each chapter
    div = re.findall('<li>(.*?)</div>', html, re.S)
divV = ''.join(div)
list = re.findall('href="(.*?)">(.*?)<', divV)

# Download each section(loop)
for chapter_info in list:
    list_url, list_chapter = chapter_info
    list_url = url.replace("index.html", "") + list_url
    print(list_url, list_chapter)
